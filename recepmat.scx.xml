<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Screen</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>884117559</timestamp>
		<class>dataenvironment</class>
		<classloc/>
		<baseclass>dataenvironment</baseclass>
		<objname>Dataenvironment</objname>
		<parent/>
		<properties>Name = "Dataenvironment"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2>1</reserved2>
		<reserved3/>
		<reserved4>2</reserved4>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QO</uniqueid>
		<timestamp>1183737050</timestamp>
		<class>formamsl</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>Formamsl1</objname>
		<parent/>
		<properties>Height = 522
Width = 671
DoCreate = .T.
Caption = "Alta de Recepcion de Mateial"
KeyPreview = .T.
WindowState = 0
Name = "Formamsl1"
Marco.ZOrderSet = 2
Marco.Name = "Marco"
</properties>
		<protected/>
		<methods>PROCEDURE Init
* nModo --&gt; Almacena la forma en que se manda llamar la ventana
* 1 = Agregar
* 2 = Modificar
* 3 = Eliminar
LParameter nModo,nRec,cFolio

iF Not Opendbf ('Provedor','Numprov')Or;
	Not Opendbf ('Docum','Tiponum') or ;
	Not Opendbf ('Movim','Tiponumpar') or;
	Not Opendbf ('Arts','Numart') or;
	Not Opendbf ('Usuarios','Numuser') or;
	Not Opendbf ('Almacen','NumAlm')or;
	Not Opendbf ('Minv','Tiponumpar')or;
	Not Opendbf ('Entradas','TipoNumpar')or;
	Not Opendbf ('Multialm','ArtAlm')or;
	Not Opendbf ('Series','ArtSerie')
	Return .f.
Endif

*Cursor para temporal
Create Cursor Temp (;
	Numart		C(20), ;		
	Desc		C(60),;
	Cant		N(12,4),;
	Pend		N(12,4),;
	Unidad		C(5),;
	Precio		N(12,4),;
	Pjedesc 	N(12,4),;
	Impuesto1 	N(12,4),;
	Impuesto2 	N(12,4),;
	Importe 	N(12,4),;
	Numpar		C(3),;
	DocAnt		C(15),;
	Series		M(10))
	
Sele temp
Index on numpar tag numpar
INDEX ON NUMART TAG NUMART
SET ORDER TO NUMPAR

*Cursor Datos Extra
Create Cursor Tempext (;
	Dato		C(50),;		
	Valor		C(50))

*Cursor para Series
Create Cursor TempgSer (;
	Serie		C(30))
	
	Sele TempgSer	
	FOR I= 1 TO 50
		APPEND BLANK
	ENDFOR
	GO TOP

*Cursor para Series para validaciones
Create Cursor TempgSerVal (;
	Serie		C(30))
		
*Cursor Grrid Documentos
Create Cursor TempgOrd (;	
		Numdoc		 C(10),;
		Fecha 		 D(8),;
		Numprov		 C(10),;
		NomProv	     C(30),;
		Importe  	 N(12,2),;
		Impuesto1    N(12,2),;
		Impuesto2    N(12,2),;
		Divisa		 C(1),;
		STATUS  	 C(20),;
		Total		 N(12,2))
	
* IniCiawsliza la variable donde se almacena el subtotal de cada factura
Thisform.nSubTotal = 0

	* Muestra los datos de TEMP
	With ThisForm.Grid1
		.RecordSourceType = 1
		.RecordSource = 'Temp'
		.Column1.ControlSource = 'Temp.NUMART'
		.Column2.ControlSource = 'Temp.DESC'
		.Column3.ControlSource = 'Temp.CANT'
		.Column4.ControlSource = 'Temp.UNIDAD'
		.Column5.ControlSource = 'Temp.PRECIO'
		.Column6.ControlSource = 'Temp.pjedesc'
		.Column7.ControlSource = 'Temp.impuesto1'
		.Column8.ControlSource = 'Temp.IMPORTE'		
	EndWith
	
	* Muestra los datos de TEMP
	With ThisForm.Grid2
		.RecordSourceType = 1
		.RecordSource = 'Tempext'
		.Column1.ControlSource = 'Tempext.dato'
		.Column2.ControlSource = 'Tempext.valor'		
	EndWith
	
	*Grid para proveedores
	Thisform.LockScreen = .T.
	With ThisForm.Grid3
		.RecordSourceType = 1
		Select TempgOrd
		Go Bott
		for i= 1 to 15
			if not bof()
				skip -1
			endif
		endfor
		.RecordSource = 'TempgOrd'
		.Column1.ControlSource = 'Allt(TempgOrd.NUMDOC)'
		.Column2.ControlSource = 'MEXDATE2(TempgOrd.FECHA)'
		.Column3.ControlSource = 'TempgOrd.Nomprov'
		.Column4.ControlSource = 'TempgOrd.Importe'
		.Column5.ControlSource = 'TempgOrd.Impuesto1'
		.Column6.ControlSource = 'TempgOrd.Divisa'
		.Column8.ControlSource = 'TempgOrd.Total'
		.Setfocus
		.Refresh
	EndWith
	Thisform.LockScreen = .F.
	
	*Grid para proveedores
	Thisform.LockScreen = .T.
	With ThisForm.Grid4
		.RecordSourceType = 1
		.RecordSource = 'TempgSer'
		.Column1.ControlSource = 'TempgSer.Serie'
		.Setfocus
		.Refresh
	EndWith
	Thisform.LockScreen = .F.

WITH THISFORM
	
	*Llenamos la tabla de los datos extra
	.Extras()
	.Grid3.Visible = .F.
	.Grid4.Visible = .F.
	
	* Si no recibe ningun parametro, nModo = 1 Agregar
	If PCount()==0
		nModo=1
	EndIf
	
	.nModo = nModo
		
	if nModo = 2 or nModo = 3
	
	    Sele Docum
		=Seek('RM'+ cFolio)
		iF Found()
		
			nRec = Recno()
			thisform.nmodo = nModo
	
			GoTo nRec
			thisform.folio.value= docum.numdoc
			
		Else
			aviso('No se encontró registro')
		Endif	
	
	EndIf

	
	DO CASE
		
		CASE .nModo == 1
	
			.Caption = 'Agregando Recepción de Material'
			.Save.Caption = '\&lt;Agregar'
			
			iF Not opendbf('Ciaws')
				Return .f.
			Endif
			
			Sele Ciaws
			 Thisform.Folio.value = Ciaws.sigRM
			Use
			
			if Not Opendbf('Cia')
				Return .f.
			Endif
			
			Sele Cia
			 .TC.VALUE = CIA.TCCREDITO
			Use
		
			Sele Docum
			.TC.ENABLED = .F.
			thisform.nTC = thisform.TC.Value
			.Boton6.visible = .F.
			.Factura.visible = .F.
			.status.caption= ''
			.nomuser.value = nomuser
			* Sucursal y alamcen
			.leeSuc1.NumAlm.Value = _NumAlm
			.leeSuc1.NomAlm.Value = _NomAlm
			
			Select Temp
			*Append Blank		
			
		CASE .nModo == 2
			
			.Caption = 'Modificando Recepción de Material'
			.Save.Caption = '\&lt;Modificar'
			.Save.Visible = .F.
			
			sele docum
			GoTo nRec
			Thisform.folio.value= Docum.numdoc
				
			.TC.ENABLED = .F.
			.Factura.enabled= .F.
			.Status.caption= ''
			* Manda llamar el metodo para cargar la informacion
			.CargarInfo()
			thisform.nTC = thisform.TC.Value
			
			.SetAll('Enabled',.f.)
			.Cerrar.Enabled = .t.
			.Boton6.Enabled = .t.
			
		CASE .nModo == 3
			
			.Caption = 'Eliminar Recepción de Material'
			.Save.Caption = '\&lt;Eliminar'
			.status.caption= ''
			
			* Manda llamar el metodo para cargar la informacion
			.CargarInfo()
			thisform.nTC = thisform.TC.Value
			* Deshabilitar todo
			.SetAll('Enabled',.f.)
			.Save.Enabled = .t.
			.Cerrar.Enabled = .t.
	
	ENDCASE

ENDWITH


ENDPROC
PROCEDURE KeyPress
LPARAMETERS nkeycode,nshiftaltctrl


* Cerrar la ventana si presiona [Esc]
If nKeyCode == 27
	ThisForm.Release
EndIf
ENDPROC
PROCEDURE Unload
* Borrar los temporales
DelAlias('Temp')
*DelAlias('Temp2')
DoDefault()

ENDPROC
PROCEDURE cargarinfo
* Metodo para cargar la informacion del almacen
WITH THISFORM
			
	Sele Docum
	.Folio.Value = docum.numdoc

	Sele Docum
	=Seek('RM' + .Folio.value,'Docum','TipoNum')
	iF Found()
	
		.Leefecha1.Setvalue(Docum.fecha)
		.Subtotal.value		= Docum.importe
		.Iva.value			= Docum.impuesto1
		.descuento.value	= Docum.descuento
		.Importe.value  	= Docum.importe- Docum.descuento
		.Total.value 		= Docum.importe- Docum.descuento + Docum.impuesto1
		.Obs.value  		= Allt(Docum.obs)
		.Direnvio.value 	= Allt(Docum.direnvio)
		.Otrosdatos.value 	= Allt(Docum.otrosdatos)
		.Tc.value			= Docum.tc
		.NumdocO.value		= Padl(Allt(Docum.DocAnt),10)
		.Leecve1.clave.value  = Docum.Numprov
		.Leecve1.clave.valid()
		.LeeSuc1.NumAlm.value = Docum.NumAlm
		.LeeSuc1.NumAlm.valid()
	
		*Llenamos el temp de datos extra
		Sele tempext
		Go Top
		i = 0
		FOR i = 0 to 100 STEP 1
			Sele tempext
			Replace	valor	with allt(ValProp(Docum.datosextra, allt(tempext.dato)))
			
			if eof()
				Exit
			else
				skip +1
			ENDIF
		ENDFOR
		
		Sele Docum
		IF DOCUM.DIVISA = 'P'
				.DIVISA.VALUE	=	1
		ENDIF
		iF dOCUM.DIVISA = 'D'
				.DIVISA.VALUE 	=   2
		ENDIF
		
			
		*LEYENDA DE STATUS Y LLENANDOLA
		DO CASE
		
			CASE .nmodo = 2
				
				if Docum.status= 11
						.status.caption  = 'Parcial'
						.boton12.visible = .F.
						.boton10.visible = .F.
						.boton5.visible  = .F.
						
				ELSE
					.STATUS.CAPTION =''
				ENDIF
				
				if Docum.status= 12
						.status.caption  = 'Completa'
						.boton12.visible = .F.
						.boton10.visible = .F.
						.boton5.visible  = .F.
						
				ELSE
					.STATUS.CAPTION =''
				ENDIF
				
			CASE .nModo= 3
				
				if Docum.status= 11
						.status.caption  = 'Parcial'
						.boton12.visible = .F.
						.boton10.visible = .F.
						.boton5.visible  = .F.
						
				ELSE
					.STATUS.CAPTION =''
				ENDIF
				
				if Docum.status= 12
						.status.caption  = 'Completa'
						.boton12.visible = .F.
						.boton10.visible = .F.
						.boton5.visible  = .F.
						
				ELSE
					.STATUS.CAPTION =''
				ENDIF

		ENDCASE
				
	Else
	
		Aviso ('No se encontró')
	
	Endif
	
	SELE temp
	GO TOP
	
	i = 1
	For i = 1 to 100 STEP 1
		cTipoNumPar = 'RM' + Padl(Allt(.Folio.Value),10) + padl(allt(str(i)),3)
		Sele Movim
		=Seek(cTipoNumPar,'Movim','TipoNumPar')
		if found()
			EXIT
		ENDIF
	ENDFOR
	

	SELE MOVIM
	=Seek(cTipoNumPar,'Movim','Tiponumpar')
	If found()
	
		SELE MOVIM
		Scan While Movim.Numdoc == Padl(Allt(.Folio.Value),10)
	
			Select Temp
				Append Blank
					Replace	Numart		With	padr(Allt(Movim.Numart),20),;
							Cant		With	Movim.CANT,;
							unidad		with 	Movim.unidad,;
							precio		With	Movim.precio,;
							Importe		With	Movim.cant * movim.precio,;
							impuesto1	with	Movim.impuesto1,;
							impuesto2	with	Movim.impuesto2,;
							pjedesc		with	Movim.pjedesc,;
							DocAnt		with	Movim.DocAnt,;
							Numpar		with	Movim.Numpar,;
							Series		with	Movim.nSeries
		
		
			* Mostrar la descripcion del articulo
			If Seek(MOVIM.NUMART,'Arts')
				Replace	temp.DESC	With	Arts.DESC
			EndIf
			
			* Descripciones
			if empty (movim.numart)
				Replace temp.Desc with allt(Movim.Obs)
			endif
			
			* SE BRINCA DE RENGLON POR QUE YA HAY 30
			IF NOT EOF()
				SKIP 1			
			ENDIF
			
			Select MOVIM
			
		EndScan
	
	Endif
	
	*Calcular Totales
	thisform.cargartotales()

	Sele Temp
	GO TOP
	
	*Actualizar
	.Grid1.Refresh()
	
ENDWITH

ENDPROC
PROCEDURE cargartotales
*** cargartotales

**********************************
*Calcular totales
SELE temp
sum (temp.importe) to thisform.nSubtotal
SUM (temp.IMPORTE * temp.PJEDESC/100) TO THISFORM.ndescuento
SUM ((temp.importe - (temp.IMPORTE * temp.PJEDESC/100)) * temp.impuesto1/100) to thisform.nimpuesto

with thisform
.Subtotal.value= .nSubtotal
.descuento.value= .ndescuento
.importe.value = .subtotal.value - .descuento.value
.iva.value = .nimpuesto
.total.value = .importe.value + .iva.value

endwith
THISFORM.GRID1.REFRESH
ENDPROC
PROCEDURE entrada
*Generar la entrada de los articulos a nombre del otro almacen
WITH THISFORM
	
	*Abrir CIA
	If Not Opendbf ('CIA')
	Return .F.
	Endif
	
	*Generando variables para grabar.
	nTc			= TcSist
	dFecha		= .Leefecha1.value
	nPrecioMN 	= 0
	nCostoMN  	= 0
	nCostoDls 	= 0
	nStatusO  	= 0
	
	nAlmActual = _Numalm
	
	_NumAlm = Padl(Allt(.Leesuc1.Numalm.value),2)
	
	*Buscar el folio del siguiente movimiento
	cFolio  = Padl(Allt(.Folio.value),10)
	cFolioO = Padl(Allt(.NumdocO.value),10)
	
	Sele Temp
	Go Top
	SCAN
		
		iF Not Empty(Temp.Numart)
			
			nSaldo 		= 0
			cTipoparO	= ''
			
			*Actualizar saldo de la Orden
			nSaldo     = Temp.Cant
			
			cTipoparO = ' O' + cFolioO + Temp.Numpar
			
			*Actualizar Saldo de Partidas		
			Sele  Movim
			=Seek(cTipoparO,'Movim','TiponumPar')
			iF Found()
				Sele Movim
					Replace	Pend	with	Movim.Pend - nSaldo
				
				*Evento para lo Pendiente
				*SDAddEvent ('Movinv',cTipoparOC,"","",1)
				
			Endif
			
			*Actualizar Status de la Orden
			cTipoO = ' O' + Padl(Allt(.NumdocO.Value),10)
			
			*Actualizar Saldo de Partidas		
			Sele  Docum
			=Seek(cTipoO,'Docum','Tiponum')
			iF Found()
					
				Sele Docum
					Replace	Status	with	nStatusO
				
				*Evento de Cambio de status
				*SDAddEvent ('AddOC',cTipoOC,"","",2)
				
			Endif
			
			*Actualizar Grid
			.Grid1.Refresh()
			
			*Validar la divisa del documento para ajustar sus costos
			DO CASE
			
				Case .Divisa.value	=	1
					nPrecioMN = Temp.Precio
					nCostoMN  = Temp.Precio
					nCostoDls = Temp.Precio / nTc
					
				Case .Divisa.value	=	2
					nPrecioMN = Temp.Precio * nTc
					nCostoMN  = Temp.Precio * nTc
					nCostoDls = Temp.Precio
			
			ENDCASE
			
			*Buscar el articulo en Arts
			Sele Arts
			=Seek(Padl(Allt(Temp.Numart),20),'Arts','Numart')
			cNumart = Arts.Numart

			*Afectar inventario
			=Entrada(;
			  	Padl(Allt(Temp.Numart),20),;
	  			Temp.cant,;
	  			Date(),;
	  			'RM',;
	  			cFolio,;
	  			Temp.Numpar,;
				'',;
	  			Padl(Allt(.LeeCve1.Clave.value),5),;
	  			nPrecioMN,;
	  			nCostoMN,;
	  			nCostoDls,;
	  			Arts.costopro,;
	  			'',;
	  			'',;
	  			'',;
	  			Allt(cFolioO),;
	  			'',;
	  			'',;
	  			cFolioO)
						
				 Sele Minv
					Replace	nSeries		with	Temp.Series
						
				*LParameter NArt,CantEnt,
				*FechaEnt, TDoc, NDoc,
				*NPar, NCli,
				*NProv, PrecioMN,
				*CostoMN, CostoDls, CostoProMN,
				*Pedimento,FechaPed,Aduana,
				*cLote,dCaduc, cSeries, cRefer
				
				********************************************************
		  		*Agregar evetos SD
	   			*Sele Multialm
	   			*cArtAlm = cNumArt + _NumAlm     	
	   			*=Seek (cArtAlm,'Multialm','ArtAlm')
	   			*SDAddEvent ('ActExist',cArtAlm,"","",2)
	   			
		  		*Sele Minv			
	            *cTipoNumpar = 'RM' + cFolio + Numpar
	            *= Seek (cTipoNumpar ,'Minv','Tiponumpar')
	           	*SDAddEvent ('Movinv',cTipoNumpar,"","",1)
	           	
	           *Sele Entradas
	           *cTipoNumpar = 'RM' + cFolio + Numpar
	           * = Seek (cTipoNumpar ,'Entradas','Tiponumpar')
	           *SDAddEvent ('Movinv',cTipoNumpar,"","",1)
	        	*********************************************************
		
		Endif
			
	ENDSCAN
	
	
	i = 1
	For i = 1 to 100 STEP 1
		cTipoO = ' O' + Padl(Allt(.NumdocO.Value),10) + padl(allt(str(i)),3)
		Sele Movim
		=Seek(cTipoO,'Movim','TipoNumPar')
		if found()
			EXIT
		ENDIF
	ENDFOR
	
	nStatus = 0
	*Actualizar Status de la Orden
	Select Movim	
	=Seek(cTipoO,'Movim','TipoNumPar')
	if Found()
		
		Sele Movim
		Scan while ' O' + Padl(Allt(.NumdocO.Value),10) = movim.Tipodoc + Movim.numdoc
			
			iF Movim.Pend &lt;&gt; 0
			
				iF Movim.Cant	=	Movim.Pend
					nStatus = 0
				Else
					nStatus	= 11
					Exit
				Endif
			
			Else
				nStatus	= 12
			Endif
			
		Endscan
		
	Endif
	
	cTipoOC = ' O' + Padl(Allt(.NumdocO.Value),10) 		
	Sele  Docum
	Go Top
	=Seek(cTipoOC,'Docum','Tiponum')
	iF Found()
			
		Sele Docum
			Replace	Status	with	nStatus
		
		*Evento de Cambio de status
		*SDAddEvent ('AddOC',cTipoOC,"","",2)
		
	Endif
	
	*Regresar almacen al su lugar
	_Numalm = nAlmActual
						
	Wait Window 'La Entrada han sido procesada' NoWait
	
	*Guardar todo de nuevo
	Sele Cia
	Use

	*Cierra la ventana
	.Release
	
EndWith



ENDPROC
PROCEDURE extras

*Ponemos los datos solicitados
Sele tempext
append blank
	Replace tempext.dato	with 'Contacto 2'
	
Sele tempext
append blank
	Replace tempext.dato	with 'E-Mail 2'
	
Sele tempext
append blank
	Replace tempext.dato	with 'Tramitador'
	
Sele tempext
append blank
	Replace tempext.dato	with 'Comprador'
	
Sele tempext
append blank
	Replace tempext.dato	with 'Condiciones de Pago'

Sele tempext
append blank
	Replace tempext.dato	with 'Núm. Cot. Proveedor'

Sele tempext
append blank
	Replace tempext.dato	with 'Tiempo de Entrega'
	
Sele tempext
append blank
	Replace tempext.dato	with 'Fecha Límite Entrega'
	
Sele tempext
append blank
	Replace tempext.dato	with 'Documento'
	
Sele tempext
append blank
	Replace tempext.dato	with 'Referencia'
	
Sele tempext
append blank
	Replace tempext.dato	with 'Núm. Cliente'
ENDPROC
PROCEDURE moneda
lPARAMETERS nDivisa
*** MONEDA
* cAMBIA LOS PRECIOS DE LA GRID, SI CAMBIA LA MONEDA

Sele temp

	DO CASE
		Case ndivisa = 1  &amp;&amp; Pesos
			Scan		
				nNuevoPrecio 	= temp.precio
				replace temp.precio 	with (nNuevoPrecio * thisform.tc.value),;
						temp.importe 	with	temp.cant * temp.precio
			endscan
		
		Case ndivisa = 2  &amp;&amp; Dolares
			Scan		
				nNuevoPrecio 	= temp.precio
				replace temp.precio 	with (nNuevoPrecio / thisform.tc.value),;
						temp.importe 	with	temp.cant * temp.precio
			endscan
	endcase		



**********************************
*Calcular totales
SELE temp
sum (temp.importe) to thisform.nSubtotal

with thisform
	.Subtotal.value= 	.nSubtotal
	.descuento.value= 	.nSubtotal * 0.28
	.importe.value	= 	.subtotal.value - .descuento.value
	.iva.value		=	.importe.value * .15
	.total.value	= 	.importe.value  + .iva.value
	
endwith	
sele temp
go top
thisform.grid1.setfocus
THISFORM.GRID1.REFRESH

ENDPROC
PROCEDURE salida
*Registrar la Salida de los articulos
WITH THISFORM
	
	*Obtener TC del sistema
	nTc	= TcSist
	
	*Abrir CIA
	If not opendbf ('CIA')
	Return .F
	Endif
	
	
	nAlmActual = _Numalm
	
	_NumAlm = Padl(Allt(.Leesuc1.Numalm.value),2)
		
	*Realizar las Salidas del Inventario
	Sele Temp
	Go Top
	SCAN
		
		cTipoparO = ''
		nSaldo 	  = 0
			
		*Actualizar saldo de la Orden
		cTipoparO = ' O' + Padl(Allt(.NumdocO.Value),10) + Padl(Allt(Temp.Numpar),3)
		nSaldo     = Temp.Cant
		
		*Actualizar Saldo de Partidas		
		Sele  Movim
		Go Top
		=Seek(cTipoparO,'Movim','TiponumPar')
		iF Found()
		
			Sele Movim
				Replace	Pend	with	Movim.Pend + nSaldo
				
			*SDAddEvent ('Movinv',cTipoparOC,"","",1)
			
		Endif
			
		*Actualizar Status de la Orden
		cTipoOC = ' O' + Padl(Allt(.NumdocO.Value),10)
			
		*Buscar el folio 	
		cFolio = Padl(Allt(.Folio.value),10)
		
		*Colocarme en ARTS
	Sele Arts
		=Seek(Padl(Allt(Temp.Numart),20),'Arts','Numart')
		cNumart = Arts.Numart
		
		*Validar la divisa del documento para ajustar sus costos
		Do Case
		
			Case .Divisa.value	=	1
				nPrecioMN = Temp.Precio
				nCostoMN  = Temp.Precio
				nCostoDls = Temp.Precio / nTc
				
			Case .Divisa.value	=	2
				nPrecioMN = Temp.Precio * nTc
				nCostoMN  = Temp.Precio * nTc
				nCostoDls = Temp.Precio
		
		ENDCASE
						
		*Afectar inventario
		=Salida(;
		  	Padl(Allt(Arts.Numart),20),;	
			Temp.Cant,;					
			DATE(),;						
			'CM',;							
			cFolio,;						
			Temp.Numpar,;					
			'',;							
			'',;							
			nPrecioMN,;
	  		nCostoMN,;				
			'',;								
			'',;							
			cFolio)		
		
		 Sele Minv
			Replace	Costo		with	nCostoMN,;
					Costodls	with	nCostoDls,;
					nSeries		with	Temp.Series
					
		********************************************************
		*Agregar evetos SD
		*Sele Multialm
		*cArtAlm = cNumArt + _NumAlm     	
		*=Seek (cArtAlm,'Multialm','ArtAlm')
		*SDAddEvent ('ActExist',cArtAlm,"","",2)
			
		*Sele Minv			
*cTipoNumpar =   'CM' + cFolio + Numpar
*= Seek (cTipoNumpar ,'Minv','Tiponumpar')
	*SDAddEvent ('Movinv',cTipoNumpar,"","",1)
	*********************************************************
		
		*Actualizar disponible en Entradas
		Select Entradas	
		Go Top
		cTipoOM = 'RM' + Padl(Allt(.Folio.Value),10) + Temp.Numpar
		=Seek(cTipoOM,'Entradas','TipoNumPar')
		if Found()
			
			*Sele Entradas
			*Scan while 'RM' + Padl(Allt(.Folio.Value),10) = Entradas.Tipodoc + Entradas.numdoc
				
				Sele Entradas
					Replace	Disp	with	0
				
			*Endscan
			
		Endif
		
		*Actualizar disponible en Minv
		Select Minv	
		Go Top
		cTipoOR = 'RM' + Padl(Allt(.Folio.Value),10) + Temp.Numpar
		=Seek(cTipoOR,'Minv','TipoNumPar')
		if Found()
			
			*Sele Minv
			*Scan while 'RM' + Padl(Allt(.Folio.Value),10) = Minv.Tipodoc + Minv.numdoc
				
				Sele Minv
					Replace	Disp	with	0
				
			*Endscan
			
		Endif
		
		iF Not Empty(Temp.Series)
		
			*Borrar las Series		
			*Inicializar Variables
			nCant   = 0
			cNumart = ""
			cSeries = ""
			
			*LLenar Variables
			nCant   = Temp.Cant
			cNumart = Padl(Allt(Temp.Numart),20)
			cSeries = Temp.Series
				
			*Ver si usa series el Articulo
			Sele Arts
			=Seek(cNumart,'Arts','Numart')
			iF Found()
				
				lSeries = Arts.Series
				
			Endif
				
			iF lSeries = .T.
				
				Sele TempgSerVal
				Zap
			
				For i=1 to 50
						
					cSerieL = mLine(cSeries,i)
					cSerie = Padl(Allt(cSerieL),30)

					iF Not Empty(cSerie )
					
						Sele TempgSerVal
							Append Blank
								Replace	Serie	with	cSerie
					
					Endif
					
				Next
				
				*Validar que no este una serie repetida entre las ya creadas
				Sele TempgSerVal
				Go Top
				Scan
				
					cArtSerie = cNumart  + Padl(Allt(TempgSerVal.Serie),30)
					Sele Series
					Go Top
					=Seek(cArtSerie,'Series','ArtSerie')
					iF Found()
						Sele Series
							Delete
					Endif
					
				Endscan	
				
			Endif
		
		Endif
		
	  Sele Temp
		
	ENDSCAN	
	
	i = 1
	For i = 1 to 100 STEP 1
		cTipoO = ' O' + Padl(Allt(.NumdocO.Value),10) + padl(allt(str(i)),3)
		Sele Movim
		Go Top
		=Seek(cTipoO ,'Movim','TipoNumPar')
		if found()
			EXIT
		ENDIF
	ENDFOR
	
	nStatus = 0
	*Actualizar Status de la Orden
	Select Movim	
	Go Top
	=Seek(cTipoO,'Movim','TipoNumPar')
	if Found()
		
		Sele Movim
		Scan while ' O' + Padl(Allt(.NumdocO.Value),10) = movim.Tipodoc + Movim.numdoc
			
			iF Movim.Cant	=	Movim.Pend
				nStatus = 0
			Else
				nStatus	= 11
				Exit
			Endif
			
		Endscan
		
	Endif

	cTipoOC = ' O' + Padl(Allt(.NumdocO.Value),10) 		
	Sele  Docum
	Go Top
	=Seek(cTipoOC,'Docum','Tiponum')
	iF Found()
			
		Sele Docum
			Replace	Status	with	nStatus
		
		*Evento de Cambio de status
		*SDAddEvent ('AddOC',cTipoOC,"","",2)
		
	Endif
	
	*Regresar almacen a su lugar
	_Numalm = nAlmActual
	
	Wait Window 'La Salida han sido procesada' NoWait
	
	*Cerrar cia							
	Sele CIA
	Use
	
ENDWITH

ENDPROC
PROCEDURE saveinfo
* Save info
* Metodo para grabar la informacion
WITH THISFORM

	cExtra = ''
	*Sacamos los valores del tempext
	Sele tempext
	Go Top
	Scan
		
		cExtra = cExtra + ' ' + allt(tempext.dato) + '=' + allt(tempext.valor) +  chr(13)
		
	ENDSCAN

	*IniCiawsrlizar varibles
	if .nModo = 1

		if not opendbf ('Ciaws')
			Return .F.
		endif
		
		Sele Ciaws
		cFolio = Padl(Allt(Ciaws.SigRM),10)
		thisform.folio.value = cfolio
		cSigRM = SigDoc(cFolio)
		Replace Ciaws.sigRM with padl(allt(cSigRM),10)
		use

	else	&amp;&amp;6 es Modo 2 o 3

		cFolio = Padl(allt(.Folio.value),10)
		
	endif
		
		*Variables
		cNumAlm = Padl(allt(.LeeSuc1.NumALm.value),2)		
			
	Select Docum
		Append Blank
			Replace	Tipodoc			With	'RM',;
					Numdoc			With	cFolio,;
					Fecha			With	.Leefecha1.value,;
					FECHACAPT		With	Date(),;
					Pjedesc			WITH	 .descuento.value,;
					Numprov			With	.leecve1.clave.value,;
					Divisa			With	IIF (.DIVISA.vALUE = 1,'P','D'),;
					Importe			With	.Subtotal.value,;
					Descuento		With	.descuento.value,;
					DESCUENTOg		With	0,;
					Impuesto1		With	.iva.value,;
					Impuesto2		With	0,;
					TC				With	.TC.value,;
					Numalm			With	cNumAlm,;
					Numuser			With	NumUser,;
					Obs				With	allt(.obs.value),;
					Direnvio		with	allt(.direnvio.value),;
					Otrosdatos		with 	allt(.otrosdatos.value),;
					Datosextra		with 	cExtra,;
					DocAnt			with	Padl(Allt(.NumdocO.value),10)	
					

		*Agregando el detalle en movim
		sele temp
		Scan
			
			* Salirme si esta vacio el numero de articulo
			If Empty(temp.NUMART) and empty(Temp.Desc)
				DELETE
				Loop
			EndIf
			
			If Not Empty(Temp.Numart) and Temp.Cant =&lt; 0
				DELETE
				Loop
			EndIf

			*Crea los registros de los articulos en Movim.DBF
			Select Movim
				Append Blank
					Replace	Tipodoc			With	'RM',;
							Numdoc			With	cFolio,;
							Numpar			With	Padl(Allt(Temp.Numpar),3),;
							Numart			With	PADL(ALLT(temp.numart),20),;
							PJEDESC			With	Temp.pjedesc,;
							Unidad			WITH	Temp.UNIDAD,;
							Precio			With	Temp.precio,;
							Cant			With	Temp.cant,;
							Pend			With	Temp.cant,;
							Impuesto1		With	Temp.impuesto1,;
							Impuesto2		With	Temp.impuesto2,;
							DocAnt			with    Temp.DocAnt,;
							nSeries			with	Temp.Series
				
				if empty(Temp.numart)
					replace  obs		with  	Allt(temp.Desc)
				endif	
			
			*Guardar la Series en su lugar
			Sele Temp
			iF Not Empty(Temp.Series)
			
				cSeries = Temp.Series
				
				Sele TempgSerVal
				Zap
			
				For i=1 to 50
						
					cSerieL = mLine(cSeries,i)
					cSerie = Padl(Allt(cSerieL),30)

					iF Not Empty(cSerie )
					
						Sele TempgSerVal
							Append Blank
								Replace	Serie	with	cSerie
					
					Endif
					
				Next
				
				Sele TempgSerVal
				Go Top
				Scan
				
					Sele Series
						Append Blank
							Replace	Numart	with Padl(Allt(Temp.Numart),20),;
									Serie	with Padl(Allt(TempgSerVal.Serie),30),;
									DocEnt	with 'RM' + cFolio,;
									Numprov	with Padl(Allt(.leecve1.clave.value),5),;
									Numalm	with _NumAlm,;
									Status	with "D",;
									FecEnt	with .Leefecha1.value
								
				Endscan
				
				*Sele Series
				*cArtSerie = PADL(ALLT(Temp2.Numart),20)  + Padl(Allt(Temp2.Serie),30)   	
				*SDAddEvent ('MovSeries',cArtSerie,"","",1)
			
			Endif
			
			*Vuelve a iniCiawsr el ciclo en la misma tabla
			Sele temp		
		
		Endscan

		SELE TEMP
		SET RELATION TO 'RM' + DOCUM.NUMDOC + NUMPAR INTO MOVIM,;
					 PADL(ALLT(NUMART),20) INTO ARTS


		if Not Opendbf ('Cia')
			Return .F.
		Endif

			Sele Cia

			Sele TEMP
				SENDREP('FtoRm')
				
		Sele Cia
		use					
		
ENDWITH



ENDPROC
PROCEDURE validainfo
*
* Valida la informacion
*
WITH THISFORM

	If .nModo == 1
			
		if not opendbf('Ciaws')
			return .f.
		endif
		
		Sele Ciaws
		cNumsig = Ciaws.sigRM
		thisform.Folio.value = cNumsig
		use
				
	Endif
	
	If Empty(.leecve1.clave.Value)
		Alerta('No se puede omitir el Provedor')
		.leecve1.clave.SetFocus
		Return .F.
	EndIf	

	If Empty(.Leefecha1.value)
		Alerta('No se puede omitir la fecha')
		.Fecha.SetFocus
		Return .F.
	EndIf	
	
	
	*Validar que los articulos con series tengan las series necesarias
	Sele Temp
	Scan
		
		*Inicializar Variables
		nCant   = 0
		cNumart = ""
		cSeries = ""
		
		*LLenar Variables
		nCant   = Temp.Cant
		cNumart = Padl(Allt(Temp.Numart),20)
		cSeries = Temp.Series
		
		*Ver si usa series el Articulo
		Sele Arts
		=Seek(cNumart,'Arts','Numart')
		iF Found()
			
			lSeries = Arts.Series
			
		Endif
		
		iF lSeries = .T.
			
			Sele TempgSerVal
			Zap
		
			For i=1 to 50
					
				cSerieL = mLine(cSeries,i)
				cSerie = Padl(Allt(cSerieL),30)

				iF Not Empty(cSerie )
				
					Sele TempgSerVal
						Append Blank
							Replace	Serie	with	cSerie
				
				Endif
				
			Next
			
			*Validar que tengamos la misma cantidad de series registradas
			*Que la entrada que se va a realizar
			If Reccount('TempgSerVal') &lt;&gt; nCant
				
				Aviso('Falta colocar series en el Articulo  ' + Allt(cNumart))
				Return .F.
				Exit
			
			Endif
			
			*Validar que no este una serie repetida entre las ya creadas
			Sele TempgSerVal
			Go Top
			Scan
			
				cArtSerie = cNumart  + Padl(Allt(TempgSerVal.Serie),30)
				Sele Series
				Go Top
				=Seek(cArtSerie,'Series','ArtSerie')
				iF Found()
					Aviso('La Serie: ' + Allt(TempgSerVal.Serie) + ' Del Articulo:  ' + Allt(cNumart) + '  ya existe')
					Return .F.
					EXIT
				Endif
				
			Endscan	
			
		Endif
		
	Endscan
	
	
	* Validación para que no grabe si está pedida
	iF .Status.caption == 'Parcial' or .Status.caption == 'Completa'
		Alerta('No se puede Modificar una Recepcion que ya tiene facturas ligadas')
		Return .f.
	endif
	
	Sele Temp
	Go top	
	
ENDWITH

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3>nmodo
ntc
nsubtotal
ndescuento Descuneto del documento
nimpuesto
*cargarinfo 
*saveinfo 
*cargartotales 
*validainfo 
*fabeinst recalcula los costos de fabricación e instalación
*moneda Cambia todos los precios si cambia la moneda o divisa
*extras 
*entrada 
*salida 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B70YKT4M</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leefecha</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Leefecha1</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 60
Left = 80
Width = 96
Height = 24
TabIndex = 3
ZOrderSet = 1
Name = "Leefecha1"
Container1.Name = "Container1"
fecha.Name = "fecha"
Buscar.Name = "Buscar"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B710TV00</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>boton</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Boton6</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 477
Left = 449
Height = 30
Width = 90
Caption = "Imprimir"
TabIndex = 11
ZOrderSet = 3
Name = "Boton6"
</properties>
		<protected/>
		<methods>PROCEDURE Click
WITH THISFORM
	
	*Dettalle
	Sele temp
	nNumPar = 0
	SCAN
		
		* Salirme si esta vacio el numero de articulo
		If Empty(temp.NUMART) and empty(Temp.Desc)
			DELETE
			Loop
		EndIf
	
	ENDSCAN
	
	Sele temp
	GO TOP
	
	cNumprov = Padl(Allt(.Leecve1.clave.value),5)
	cNumDocRM = Padl(Allt(.Folio.value),10)
	
	SELE MOVIM
	Go Top
	=Seek('RM' + Padl(Allt(.Folio.value),10) + '  1','Movim','TipoNumpar')
	
	SELE Docum
	Go Top
	=Seek('RM' + Padl(Allt(.Folio.value),10),'Docum','Tiponum')

	SELE TEMP
	Go Top
	SET RELATION TO 'RM' + cNumDocRM + '  1' INTO MOVIM,;
					'RM' + cNumDocRM + '  1' INTO MINV,;
					 PADL(ALLT(NUMART),20) INTO ARTS,;
					cNumprov INTO PROVEDOR


	if Not Opendbf ('Cia')
		Return .F.
	Endif

		Sele Cia

		Sele TEMP
			SENDREP('FtoRm')
			
	Sele Cia
	use	
	
	* Cerrar la ventana
	.Release		
	
ENDWITH

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T01509N2</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda2</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "\&lt;Fecha"
Height = 16
Left = 43
Top = 62
Width = 32
TabIndex = 21
ZOrderSet = 4
Name = "Leyenda2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>boton</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>save</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 477
Left = 540
Height = 30
Width = 80
Caption = "\&lt;Grabar"
TabIndex = 12
ZOrderSet = 5
Name = "save"
</properties>
		<protected/>
		<methods>PROCEDURE Click
WITH THISFORM
	
	* Manda llamar el metodo para validar informacion
	If (.nModo == 1) or (.nModo == 2)
		If Not .ValidaInfo()
			Return
		EndIf
	EndIf
		

	DO CASE
	
		CASE .nModo == 1
			
			*VENTANA PARA PREGUNTAR SI ESTÁ CORRECTO.
			If not GetYN('Desea continuar?')
				Return
			ENDIF
		
			* Agrega el nuevo registro
			Select Docum
			Go Bott
			
			*Actualizo folio en pantalla
			if not opendbf ('Ciaws')
				Return .F.
			endif
		
			Sele Ciaws
			cFolio = Padl(Allt(Ciaws.SigRm),10)
			thisform.folio.value = cfolio
			use
		
			*Validar informacion de nuevo para no duplicar folio
			.ValidaInfo()	
				
			* Manda llamar el metodo para grabar la informacion
			.SaveInfo()
			
			*Realizar la Entrada de la Mercancia
			.Entrada()
			
			* Cerrar la ventana
			.Release
			
			
		CASE .nModo == 2
			
			*VENTANA PARA PREGUNTAR SI ESTÁ CORRECTO.
			If not GetYN('Desea continuar?')
				Return
			ENDIF
			
			Sele docum
			use
			sele movim
			use
			
			*Abrir docum
			if not opendbf('Docum','Tiponum')or;
			   not opendbf('Movim','Tiponumpar')
			   Return .f.
			endif
		
			Select Docum
			cTiponum = 'RM' + Padl(allt(.Folio.value),10)
			Scan
				Delete FOR Docum.tipodoc + Docum.Numdoc == cTiponum
			Endscan	
						
			Select Movim	
			cTipoNumPar = ctipoNum + '  1'
			=Seek(cTipoNumPar,'Movim','TipoNumPar')
			if Found()
				Scan while cTipoNum = movim.Tipodoc + Movim.numdoc
					Delete
				endscan
			endif
			
			*Manda llamar el metodo para grabar la informacion
			.SaveInfo()
			
			.Release
			
		CASE .nModo == 3
			
			If GetNY('¿Seguro que desea borrar la Recepcion de Material?')
			
				Select Docum
				cTiponum = 'RM' + Padl(allt(.Folio.value),10)
				Scan
					Delete FOR Docum.tipodoc + Docum.Numdoc == cTiponum
				Endscan
				
				i = 1
				For i = 1 to 100 STEP 1
					cTipoNumPar = cTiponum + padl(allt(str(i)),3)
					Sele Movim
					=Seek(cTipoNumPar,'Movim','TipoNumPar')
					if found()
						EXIT
					ENDIF
				ENDFOR
	
				Select Movim	
				cTipoNumPar = ctipoNum + '  1'
				=Seek(cTipoNumPar,'Movim','TipoNumPar')
				if Found()
					Scan while cTipoNum = movim.Tipodoc + Movim.numdoc
						Delete
					endscan
				endif
				
				*Realiza la Salida de lo que entro
				.Salida()
				
			EndIf
			
			* Cerrar la ventana
			.Release

	ENDCASE
	
ENDWITH	

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>closebutton</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>cerrar</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 477
Left = 278
Height = 20
Width = 50
Caption = "\&lt;Cerrar"
TabIndex = 18
ZOrderSet = 6
Name = "cerrar"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3DN0XDM11</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>leecve</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Leeproy</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 529
Left = 19
Width = 80
Height = 24
Visible = .F.
TabIndex = 13
ZOrderSet = 7
nanchoclave = 10
calias = proy
cexprnombre = proy.nombre
cformabusqueda = busproy
ldetenersinoexiste = .F.
Name = "Leeproy"
Clave.Name = "Clave"
Nombre.Height = 20
Nombre.Left = 80
Nombre.Top = 0
Nombre.Width = 370
Nombre.Name = "Nombre"
Buscar.Name = "Buscar"
</properties>
		<protected/>
		<methods>PROCEDURE LostFocus


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YI00BD1F</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda1</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "TC"
Height = 16
Left = 159
Top = 85
Width = 15
TabIndex = 16
ZOrderSet = 8
Name = "Leyenda1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YI00BD1G</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>texto</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>tc</objname>
		<parent>Formamsl1</parent>
		<properties>Alignment = 3
Value = 0
Height = 20
InputMask = "999.9999"
Left = 176
TabIndex = 5
Top = 82
Width = 60
ZOrderSet = 9
Name = "tc"
</properties>
		<protected/>
		<methods>PROCEDURE GotFocus
* got focus

* Almacena el tipo de cambio
This.Tag = Str(This.Value,10,4)

ENDPROC
PROCEDURE Valid


* Cambio el TC, actualizar el Total en MN
If Str(This.Value,10,4)&lt;&gt;This.Tag
	If Reccount('Temp')&gt;0
		Select Temp
	*	Scan
	*		Replace	precio		With	temp.precio * This.Value
*		EndScan
	EndIf
	
EndIf



thisform.ntc = this.value

*thisform.cargartotales()
*thisform.actprecio()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>statictext</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Folio</objname>
		<parent>Formamsl1</parent>
		<properties>FontBold = .T.
FontSize = 12
Alignment = 1
BorderStyle = 0
Height = 20
Left = 530
TabIndex = 20
Top = 12
Width = 100
ForeColor = 255,0,0
ZOrderSet = 10
Name = "Folio"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>texto</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Subtotal</objname>
		<parent>Formamsl1</parent>
		<properties>Alignment = 3
Value = 0
Height = 21
InputMask = "999,999,999.99"
Left = 550
ReadOnly = .T.
TabIndex = 24
Top = 38
Width = 90
ZOrderSet = 11
Name = "Subtotal"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>grid</class>
		<classloc/>
		<baseclass>grid</baseclass>
		<objname>Grid1</objname>
		<parent>Formamsl1</parent>
		<properties>ColumnCount = 8
FontSize = 8
AllowAddNew = .F.
DeleteMark = .F.
GridLines = 2
GridLineWidth = 1
Height = 200
Left = 10
Panel = 1
RecordMark = .F.
RowHeight = 17
ScrollBars = 2
TabIndex = 14
Top = 277
Width = 640
ZOrderSet = 12
Name = "Grid1"
Column1.FontSize = 8
Column1.Width = 79
Column1.Format = "!"
Column1.Name = "Column1"
Column2.FontSize = 8
Column2.Width = 182
Column2.Name = "Column2"
Column3.FontSize = 8
Column3.ColumnOrder = 3
Column3.Width = 62
Column3.Format = "Z"
Column3.InputMask = "99,999,999.99"
Column3.Name = "Column3"
Column4.FontSize = 8
Column4.ColumnOrder = 4
Column4.Width = 50
Column4.ReadOnly = .T.
Column4.InputMask = ""
Column4.Name = "Column4"
Column5.FontSize = 8
Column5.ColumnOrder = 5
Column5.Width = 76
Column5.Format = "Z"
Column5.InputMask = "999,999,999.99"
Column5.Name = "Column5"
Column6.FontSize = 8
Column6.ColumnOrder = 8
Column6.Width = 81
Column6.ReadOnly = .T.
Column6.Format = "Z"
Column6.InputMask = "999,999,999.99"
Column6.Name = "Column8"
Column7.FontSize = 8
Column7.ColumnOrder = 6
Column7.Width = 44
Column7.Format = "Z"
Column7.InputMask = "999.99"
Column7.Name = "Column6"
Column8.FontSize = 8
Column8.ColumnOrder = 7
Column8.Width = 36
Column8.Format = "Z"
Column8.InputMask = "99.99"
Column8.Name = "Column7"
</properties>
		<protected/>
		<methods>PROCEDURE When
*** WHEN EVENT GRID1

SELE TEMP
SET ORDER TO NUMPAR


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QO</uniqueid>
		<timestamp>1167152498</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid1.Column1</parent>
		<properties>FontSize = 8
Alignment = 2
Caption = "Clave"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T01509N2</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid1.Column1</parent>
		<properties>FontSize = 8
Alignment = 0
BorderStyle = 0
Format = "!"
InputMask = ""
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl
*
* Temp.NUMART
* Presiono F2 en clave
*
If nKeyCode = -1
	=F2BuscArt(This)
	NoDefault
EndIf

IF nKeyCode=7  &amp;&amp; BORRAR
		Select temp
		Replace	DESC		With	'',;
				CANT		With	0,;
				UNIDAD		With	'',;
				PRECIO		With	0,;
				PJEDESC		WITH 	0,;
				impuesto1	with    0,;
				IMPORTE		With	0
	

ENDIF
	
ENDPROC
PROCEDURE Valid
* Temp.NUMART    valid
*
With ThisForm
sele temp
** si cant es mayor o es que ya se cargó el artículo		



If Temp.cant = 0 and not empty (temp.numart)
*If Temp.cant = 0
		* Inicializar variables
		nPrecio = 0
		cLinea= ''
		* Mostrar la descripcion del articulo
		If Seek(Padl(Allt(Temp.NUMART),20),'Arts')
			Replace	temp.DESC		With	Arts.DESC,;
					temp.UNIDAD 	with    arts.unidad,;
					temp.impuesto1	with    ARTS.IMPUESTO1


		* cAMBIO DE PRECIOS POR DIVISA
			********************
			IF THISFORM.DIVISA.VALUE= 1
				* PESOS
				*** PRECIOS EN PESOS
				IF ARTS.DIVISA ='P'
						REPLACE temp.PRECIO WITH ARTS.ultcosto
			ENDIF
			
				IF ARTS.DIVISA = 'D'
					REPLACE temp.PRECIO WITH ARTS.ultcosto* THISFORM.NTC
				ENDIF	

			ENDIF

			***********************
			IF THISFORM.DIVISA.VALUE= 2
				* DOLARES
				*** PRECIOS EN PESOS
				IF ARTS.DIVISA ='P'
						REPLACE temp.PRECIO WITH ARTS.ultcosto/THISFORM.NTC
				ENDIF
				
				IF ARTS.DIVISA = 'D'
					REPLACE temp.PRECIO WITH ARTS.ultcosto
				ENDIF	

			ENDIF

			***********************
			* BRICAR LA DESCRIPCIÓN
*			KeyBoard '{ENTER}'		
				
		Else
			Aviso('Clave no Existe')
			Return
		EndIf
		
	*Else			
		
	endif	
	
*	if empty (temp.numart) AND NOT EMPTY(TEMP.dESC)
*		* Borra la informacion del registro
*		Select temp
*		Replace	DESC		With	'',;
*				CANT		With	0,;
*				UNIDAD		With	'',;
*				PRECIO		With	0,;
*				PJEDESC		WITH 	0,;
*				impuesto1	with    0,;
*				IMPORTE		With	0
*	 endif
	
	
	EndWith

thisform.cargartotales()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T01509N3</uniqueid>
		<timestamp>1065909324</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid1.Column2</parent>
		<properties>FontSize = 8
Alignment = 2
Caption = "Descripción"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid1.Column2</parent>
		<properties>FontSize = 8
BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE Valid
* Desc valid

*sELE TEMP
*cNumArt = Padl(allt(Temp.Numart),20)
*	= Seek(cNumArt,'Arts','Numart')
*	if Found()
*		Replace desc with arts.desc
*	endif

ENDPROC
PROCEDURE When
*
* Desc   when
*
* No se puede editar el campo

sELE TEMP

cNumArt = Padl(allt(Temp.Numart),20)
	 =Seek(cNumArt,'Arts','Numart')
	if Found()
		keyboard '{ENTER}'
	endif

	if Not empty(Temp.Desc)
		return .F.
	endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183472722</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid1.Column3</parent>
		<properties>FontSize = 8
Alignment = 2
Caption = "Cantidad"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YI00BD1F</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid1.Column3</parent>
		<properties>FontSize = 8
Alignment = 3
BorderStyle = 0
Value = 0
Format = "Z"
InputMask = "999,999,999.99"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

WITH THISFORM

	If nKeyCode == -2
		
		Sele TempgSer
		Scan
			
			Sele TempgSer
				Replace	Serie	with	""
				
		Endscan
		
		Sele TempgSer
		Go top
		
		.Grid4.Visible = .T.
		
		Sele Temp
		*Cargar Series
		cListaSeries = Temp.Series
		
		* Validar todas las notas
		For i=1 to 50
				
			cSerieL = mLine(cListaSeries,i)
			cSerie = Padl(Allt(cSerieL),30)

			Sele TempgSer
				Replace	Serie	with	Allt(cSerie)
			
			Sele TempgSer	
			Skip 1
			
		Next
		
		Sele TempgSer
		Go Top
		
		.Grid4.Refresh
		.Grid4.Setfocus
		
	EndIf
	
ENDWITH
ENDPROC
PROCEDURE Valid
LPARAMETERS nKeyCode, nShiftAltCtrl
* cant valid

sele temp
replace temp.importe with temp.cant * temp.precio

thisform.cargartotales()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YI00BD1G</uniqueid>
		<timestamp>1167152498</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid1.Column4</parent>
		<properties>FontSize = 8
Alignment = 2
Caption = "Unidad"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3DN0XDM11</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid1.Column4</parent>
		<properties>FontSize = 8
Alignment = 3
BorderStyle = 0
Value = 
InputMask = ""
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE When
* When
*
*   Unidad
*
* No se puede editar el campo
Return .F.



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1065909324</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid1.Column5</parent>
		<properties>FontSize = 8
Alignment = 2
Caption = "Costo Unitario"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid1.Column5</parent>
		<properties>FontSize = 8
BorderStyle = 0
Format = "Z"
InputMask = "999,999,999.99"
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl
ENDPROC
PROCEDURE Valid
*
* Costo unitario (precio)  VALID

*** multiplicar precio por cantidad
sele temp
replace temp.importe with temp.cant * temp.precio

thisform.cargartotales()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YD0M9RAL</uniqueid>
		<timestamp>1167152498</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid1.Column8</parent>
		<properties>FontSize = 8
Alignment = 2
Caption = "Importe"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YD0MEEPB</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid1.Column8</parent>
		<properties>FontSize = 8
Alignment = 3
BorderStyle = 0
Value = 0
Format = "Z"
InputMask = "999,999,999.99"
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

If nKeyCode == 13
	sele temp		
	KeyBoard '{DNARROW}'
EndIf

ENDPROC
PROCEDURE Valid
* column 8
* valid
sele temp


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YD0MEEPC</uniqueid>
		<timestamp>1167152498</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid1.Column6</parent>
		<properties>FontSize = 8
Alignment = 2
Caption = "% Desc"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YD0MEEPD</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid1.Column6</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE Valid
* pje desc valid

* Aviso ('calcular descuento solo en totales')
thisform.cargartotales()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YD0MEEPE</uniqueid>
		<timestamp>1167152498</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid1.Column7</parent>
		<properties>FontSize = 8
Alignment = 2
Caption = "% Imp"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YD0MEEPJ</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid1.Column7</parent>
		<properties>BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl
ENDPROC
PROCEDURE Valid
* pje imp   valid

thisform.cargartotales()
ENDPROC
PROCEDURE When
* cOLUMN 7

iF EMPTY (tEMP.NUMART) AND NOT EMPT (TEMP.CANT)
rEPLACE TEMP.IMPUESTO1 WITH 16
ENDIF
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>texto</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Descuento</objname>
		<parent>Formamsl1</parent>
		<properties>Alignment = 3
Value = 0
Height = 21
InputMask = "999,999,999.99"
Left = 550
ReadOnly = .T.
TabIndex = 22
Top = 58
Width = 90
ZOrderSet = 13
Name = "Descuento"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>texto</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Importe</objname>
		<parent>Formamsl1</parent>
		<properties>Alignment = 3
Value = 0
Height = 21
InputMask = "999,999,999.99"
Left = 550
ReadOnly = .T.
TabIndex = 26
Top = 78
Width = 90
ZOrderSet = 14
Name = "Importe"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YD0M9RAM</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>texto</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Iva</objname>
		<parent>Formamsl1</parent>
		<properties>Alignment = 3
Value = 0
Height = 21
InputMask = "999,999,999.99"
Left = 550
ReadOnly = .T.
TabIndex = 25
Top = 98
Width = 90
ZOrderSet = 15
Name = "Iva"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>combobox</class>
		<classloc/>
		<baseclass>combobox</baseclass>
		<objname>DIVISA</objname>
		<parent>Formamsl1</parent>
		<properties>FontSize = 8
RowSourceType = 1
RowSource = "PESOS, DOLARES"
Value = 1
Enabled = .T.
Height = 20
Left = 80
Style = 2
TabIndex = 4
Top = 82
Width = 70
ZOrderSet = 16
ReadOnly = .F.
Name = "DIVISA"
</properties>
		<protected/>
		<methods>PROCEDURE InteractiveChange
*
* Divisa
*interactiva change

* Manda llamar el metodo para cargar los costos en Dolares o Pesos
ThisForm.moneda((This.Value))

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>texto</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>Total</objname>
		<parent>Formamsl1</parent>
		<properties>Alignment = 3
Value = 0
Height = 21
InputMask = "999,999,999.99"
Left = 550
ReadOnly = .T.
TabIndex = 23
Top = 118
Width = 90
ZOrderSet = 17
Name = "Total"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YD0M9RAO</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leecve</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Leecve1</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 39
Left = 80
Width = 330
Height = 20
TabIndex = 2
ZOrderSet = 18
nanchoclave = 5
cformabusqueda = busprov
cexprnombre = provedor.nomprov
calias = Provedor
Name = "Leecve1"
Clave.Name = "Clave"
Nombre.Name = "Nombre"
Buscar.Name = "Buscar"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda4</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "Sub Total"
Left = 502
Top = 43
TabIndex = 27
ZOrderSet = 19
Name = "Leyenda4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YJ14MEYA</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda5</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "Descuento"
Left = 497
Top = 67
TabIndex = 28
ZOrderSet = 20
Name = "Leyenda5"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YJ14MEYB</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda6</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "Importe"
Left = 508
Top = 82
TabIndex = 29
ZOrderSet = 21
Name = "Leyenda6"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YJ14MEYC</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda7</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "IVA"
Left = 522
Top = 102
TabIndex = 30
ZOrderSet = 22
Name = "Leyenda7"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1YJ14MEYD</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda8</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "Total"
Left = 521
Top = 122
TabIndex = 31
ZOrderSet = 23
Name = "Leyenda8"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>boton</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Boton5</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 477
Left = 228
Height = 20
Width = 50
Caption = "Limpiar"
TabIndex = 32
ZOrderSet = 24
Name = "Boton5"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*bOTON DE LIMPIAR
sele temp
zap

for i= 1 to 50
append blan
endfor

GO TOP


thisform.grid1.setfocus
THISFORM.GRID1.REFRESH


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>boton</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Boton10</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 477
Left = 58
Height = 20
Width = 80
Caption = "Borrar Renglón"
TabIndex = 33
ZOrderSet = 25
Name = "Boton10"
</properties>
		<protected/>
		<methods>PROCEDURE Click
* BOTON DE BORRAR
sele temp

delete

THISFORM.GRID1.REFRESH
THISFORM.GRID1.SETFOCUS

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1ZJ0SBLN0</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>texto</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>factura</objname>
		<parent>Formamsl1</parent>
		<properties>Format = "K!"
Height = 21
Left = 108
TabIndex = 35
Top = 588
Visible = .F.
Width = 80
ZOrderSet = 26
Name = "factura"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1ZJ0UQKXT</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>status</objname>
		<parent>Formamsl1</parent>
		<properties>FontBold = .T.
FontSize = 14
FontUnderline = .T.
Caption = "Ordenada"
Left = 400
Top = 10
TabIndex = 36
ForeColor = 255,0,0
DisabledForeColor = 0,0,0
ZOrderSet = 27
Name = "status"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1ZM14T6RD</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda9</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "Factura"
Left = 58
Top = 588
Visible = .F.
TabIndex = 37
ZOrderSet = 28
Name = "Leyenda9"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2480OR1M6</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>boton</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Boton12</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 477
Left = 138
Height = 20
Width = 90
Caption = "Insertar Renglón"
TabIndex = 34
ZOrderSet = 29
Name = "Boton12"
</properties>
		<protected/>
		<methods>PROCEDURE Click
* BOTON DE BORRAR
sele temp

**** Inserta un registro en una BD recorriendo los registros de abajo
**** Importante: Solo usarse para bases chicas
Local Rec
	Push Key Clear
	Rec=Recno()
	Go Bottom
	
	Append Blank
	Skip -1


SET ORDER TO NUMPAR
SELE temp
SCAN
	REPLACE NUMPAR WITH ' '
ENDSCAN
	Goto m.Rec



****
**** Inserta un registro en una BD recorriendo los registros de abajo
**** Importante: Solo usarse para bases chicas
Local Rec
	Push Key Clear
	Rec=Recno()
	Go Bottom
	
	Append Blank
	Skip -1
	Do While Recno() &gt;= m.Rec and not bof()
		Scatter Memvar
		Skip
		Gather Memvar
		Skip -2
	Enddo
	Goto m.Rec
	Scatter Memvar Blank
	Gather Memvar
	*Keyboard '{DNARROW}{UPARROW}'
	Pop Key
THISFORM.GRID1.REFRESH
THISFORM.GRID1.SETFOCUS


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda3</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "Proveedor"
Left = 22
Top = 42
TabIndex = 39
ZOrderSet = 30
Name = "Leyenda3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda10</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "Divisa"
Left = 40
Top = 85
TabIndex = 40
ZOrderSet = 31
Name = "Leyenda10"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda11</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "Observaciones"
Left = 282
Top = 64
TabIndex = 41
ZOrderSet = 32
Name = "Leyenda11"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2LL0ZI5DX</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>statictext</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>nomuser</objname>
		<parent>Formamsl1</parent>
		<properties>FontBold = .F.
FontSize = 8
Alignment = 0
BorderStyle = 0
Height = 20
Left = 19
TabIndex = 19
Top = 497
Width = 211
ZOrderSet = 33
Name = "nomuser"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>texto</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>otrosdatos</objname>
		<parent>Formamsl1</parent>
		<properties>Height = 51
Left = 20
TabIndex = 6
Top = 139
Width = 240
ZOrderSet = 34
Name = "otrosdatos"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2SS0PKF2R</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>texto</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>direnvio</objname>
		<parent>Formamsl1</parent>
		<properties>Height = 60
Left = 20
TabIndex = 7
Top = 210
Width = 240
ZOrderSet = 35
Name = "direnvio"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2SS0PKF2S</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda12</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "Medio de Envio:"
Left = 22
Top = 124
TabIndex = 42
ZOrderSet = 36
Name = "Leyenda12"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_2SS0PKF2T</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda13</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "Dirección de Envio:"
Left = 22
Top = 192
TabIndex = 43
ZOrderSet = 37
Name = "Leyenda13"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_1T012N5QN</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leesuc</class>
		<classloc>..\..\msllib60\apolo.vcx</classloc>
		<baseclass>container</baseclass>
		<objname>Leesuc1</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 102
Left = 4
Width = 270
Height = 30
TabIndex = 15
ZOrderSet = 38
Name = "Leesuc1"
Label8.Caption = "\&lt;Almacen"
Label8.Name = "Label8"
NumAlm.Name = "NumAlm"
NomAlm.Name = "NomAlm"
BuscaAlm.Name = "BuscaAlm"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3DN0WE4TW</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>texto</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>textbox</baseclass>
		<objname>obs</objname>
		<parent>Formamsl1</parent>
		<properties>Height = 80
Left = 280
TabIndex = 8
Top = 80
Width = 210
ZOrderSet = 39
Name = "obs"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_3DN0XDM13</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda14</objname>
		<parent>Formamsl1</parent>
		<properties>Caption = "#\&lt;Proyecto"
Left = 19
Top = 517
Visible = .F.
TabIndex = 17
ZOrderSet = 40
Name = "Leyenda14"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4AJ0P4V5W</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>grid</class>
		<classloc/>
		<baseclass>grid</baseclass>
		<objname>Grid2</objname>
		<parent>Formamsl1</parent>
		<properties>ColumnCount = 2
FontSize = 8
AllowAddNew = .F.
DeleteMark = .F.
GridLines = 2
GridLineWidth = 1
Height = 100
Left = 280
Panel = 1
RecordMark = .F.
RowHeight = 17
ScrollBars = 2
TabIndex = 9
Top = 170
Width = 366
ZOrderSet = 41
Name = "Grid2"
Column1.FontSize = 8
Column1.Width = 133
Column1.ReadOnly = .T.
Column1.Format = "!"
Column1.Name = "Column1"
Column2.FontSize = 8
Column2.Width = 208
Column2.Name = "Column2"
</properties>
		<protected/>
		<methods>PROCEDURE When
*** WHEN EVENT GRID1

SELE TEMP
SET ORDER TO NUMPAR


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4AJ0P4V5X</uniqueid>
		<timestamp>1180392819</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid2.Column1</parent>
		<properties>FontSize = 8
Alignment = 2
Caption = "Dato"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4AJ0P4V5Y</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid2.Column1</parent>
		<properties>FontSize = 8
Alignment = 0
BorderStyle = 0
Format = "!"
InputMask = ""
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl


	
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4AJ0P4V5Z</uniqueid>
		<timestamp>1180392819</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid2.Column2</parent>
		<properties>FontSize = 8
Alignment = 2
Caption = "Valor"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4AJ0P4V60</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid2.Column2</parent>
		<properties>FontSize = 8
BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4AW0TG6RU</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>NumdocO</objname>
		<parent>Formamsl1</parent>
		<properties>FontSize = 8
Height = 21
Left = 81
TabIndex = 1
Top = 17
Width = 110
ZOrderSet = 42
Name = "NumdocO"
</properties>
		<protected/>
		<methods>PROCEDURE LostFocus
* Metodo para cargar la informacion del almacen
WITH THISFORM
	
	Select Temp
	ZAP
	.Subtotal.value		  =	0
	.iva.value			  =	0
	.descuento.value	  = 0
	.importe.value  	  = 0	
	.total.value 		  = 0
	.obs.value 	 		  = ''
	.direnvio.value 	  = ''
	.otrosdatos.value 	  = ''
	.tc.value			  = 0
	.leecve1.clave.value  = ''
	.leeSuc1.NumAlm.value = ''
		
		
	cFolio = Padl(Allt(This.value),10)

	Sele Docum
	=Seek(' O' + cFolio,'Docum','TipoNum')
	iF Found()
		
		.Leefecha1.Setvalue(Docum.fecha)
		.Subtotal.value	= docum.importe
		.iva.value		= docum.impuesto1
		.descuento.value= docum.descuento
		.importe.value  = docum.importe- docum.descuento
		.total.value 	= docum.importe- docum.descuento + docum.impuesto1
		.obs.value  = allt(docum.obs)
		.direnvio.value = allt(docum.direnvio)
		.otrosdatos.value = allt(docum.otrosdatos)
		.tc.value	= docum.tc
		.leecve1.clave.value = docum.numprov
		.leecve1.clave.valid()
		.leeSuc1.NumAlm.value = docum.NumAlm
		.leeSuc1.NumAlm.valid()
		
		*Llenamos el temp de datos extra
		Sele tempext
		Go Top
		i = 0
		FOR i = 0 to 100 STEP 1
			Sele tempext
			Replace	valor	with allt(ValProp(Docum.datosextra, allt(tempext.dato)))
			
			if eof()
				Exit
			else
				skip +1
			ENDIF
		ENDFOR
		
		sele docum
		*** cARGANDO LA DIVISA
		IF DOCUM.DIVISA = 'P'
				.DIVISA.VALUE	=	1
		ENDIF
		iF dOCUM.DIVISA = 'D'
				.DIVISA.VALUE 	=   2
		ENDIF

		*LEYENDA DE STATUS Y LLENANDOLA
		Do case
			case .nmodo = 2
				if docum.status= 9
						.status.caption ='ORDENADA'
						.boton12.visible = .F.
						.boton10.visible = .F.
						.boton5.visible = .F.
						.boton8.visible = .F.
					ELSE
						.STATUS.CAPTION =''
				ENDIF
		
			case .nmodo= 3
			.status.caption= ''

		ENDCASE
				
	Else
	
		Aviso ('No se encontró el Documento')
	
	Endif
	
	SELE temp
	GO TOP
	
	i = 1
	For i = 1 to 100 STEP 1
		cTipoNumPar = ' O' + Padl(Allt(.NumdocO.Value),10) + padl(allt(str(i)),3)
		Sele Movim
		=Seek(cTipoNumPar,'Movim','TipoNumPar')
		if found()
			EXIT
		ENDIF
	ENDFOR
	
	SELE MOVIM
	=Seek(cTipoNumPar,'Movim','Tiponumpar')
	If found()
	
		SELE MOVIM
		Scan While Movim.Numdoc == Padl(Allt(.NumdocO.Value),10)
			
			
			iF Not Empty(Movim.Obs) or Movim.Pend &gt; 0
				
				Select Temp
					Append Blank
						Replace	Numart		With	Padr(Allt(Movim.Numart),20),;
								Cant		With	Movim.Pend,;
								Pend		With	Movim.Pend,;
								Unidad		with 	Movim.Unidad,;
								Precio		With	Movim.Precio,;
								Importe		With	Movim.Pend * Movim.Precio,;
								Impuesto1	with	Movim.Impuesto1,;
								Pjedesc		with	Movim.Pjedesc,;
								DocAnt		with	' O' + PAdl(Allt(.NumdocO.value),10) + Movim.Numpar,;
								Numpar		with	Movim.Numpar
				
				* Mostrar la descripcion del articulo
				If Seek(MOVIM.NUMART,'Arts')
					Replace	Temp.DESC	With	Arts.Desc
				EndIf
				
				* Descripciones
				if empty (movim.numart)
					Replace Temp.Desc with allt(Movim.Obs)
				endif
				
				* SE BRINCA DE RENGLON POR QUE YA HAY 30
				IF NOT EOF()
					SKIP 1		
				ENDIF
			
			Endif
			
			Select MOVIM
			
		EndScan
	
	Endif
		
	
	*Calcular Totales
	thisform.cargartotales()
	
	Sele Temp
	GO TOP
	
	*Actualizar
	.Grid1.Refresh()
	
ENDWITH

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4AW0TG6RV</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>leyenda</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>Leyenda15</objname>
		<parent>Formamsl1</parent>
		<properties>FontBold = .T.
Caption = "Ord. Compra"
Left = 9
Top = 19
TabIndex = 38
ZOrderSet = 43
Name = "Leyenda15"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4AW0TG6RW</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>boton</class>
		<classloc>..\..\msllib60\msllib60.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>Boton2</objname>
		<parent>Formamsl1</parent>
		<properties>Top = 17
Left = 192
Height = 20
Width = 17
Caption = "?"
TabIndex = 44
ZOrderSet = 44
Name = "Boton2"
</properties>
		<protected/>
		<methods>PROCEDURE Click
*Buscar orden de Compra
WITH THISFORM
	
	.Grid3.Visible = .T.
	
	cNumprov 	   = Padl(Allt(Thisform.Leecve1.Clave.value),5)
			
	Sele TempgOrd
	Zap
	
	*consultar movim, docum y regcal de acuerdo a los filtros de la ventana
	cSql= ' Sele Docum.Numdoc, Docum.Fecha, Docum.Numprov, Docum.Divisa, '+;
	      ' Docum.Importe, Docum.Status, Docum.Impuesto1, Docum.Impuesto2, Docum.Descuento From Docum '+;
	     ' Where Docum.Tipodoc = " O" and '+;
	     		' Docum.Status &lt;&gt; 1 and ' +;
	     		' Docum.Status &lt;&gt; 12 and ' +;
	   		  Iif(Empty(cNumprov),".T." , " Docum.Numprov = m.Val1 ")+ ' and ' + ;
	   		  ' Not empty(Docum.Numdoc) ' +;
	   		  ' Order by Docum.Numdoc '
	   		
	*Buqueda
	if Not SqlMSL ('TempOrd' , cSql , cNumprov)
		return
	endif

	* Pasando valors a Tempg		
	Sele TempOrd
	SCAN 	
	
		Sele Provedor
		=Seek(Tempord.Numprov,'Provedor','NUMPROV')
		cNomProv= Provedor.NomProv
		
		Sele TempgOrd
			Append Blank
				Replace Numdoc    with	TempOrd.Numdoc,;
						Fecha	  with 	TempOrd.Fecha,;
						Nomprov   with 	cNomprov,;
						Importe   with  TempOrd.Importe ,;
						Impuesto1 with  TempOrd.Impuesto1,;
						Divisa    with  TempOrd.Divisa,;
						Total     with  ((TempOrd.Importe + TempOrd.impuesto1 + TempOrd.impuesto2) - TempOrd.Descuento)
		
		Sele TempOrd
		
	ENDSCAN
	
	.grid3.Refresh
	.grid3.Setfocus
	
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4BP0LCP21</uniqueid>
		<timestamp>1183472722</timestamp>
		<class>grid</class>
		<classloc/>
		<baseclass>grid</baseclass>
		<objname>Grid4</objname>
		<parent>Formamsl1</parent>
		<properties>ColumnCount = 1
FontSize = 8
DeleteMark = .F.
GridLines = 2
Height = 168
Left = 272
Panel = 1
RecordMark = .F.
RowHeight = 17
ScrollBars = 0
Top = 110
Width = 237
ZOrderSet = 46
Name = "Grid4"
Column1.FontSize = 8
Column1.Width = 232
Column1.Name = "Column1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4BP0LCP22</uniqueid>
		<timestamp>1183470343</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid4.Column1</parent>
		<properties>FontSize = 8
Caption = "Series"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4BP0LCP23</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid4.Column1</parent>
		<properties>FontSize = 8
BorderStyle = 0
Margin = 0
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

WITH THISFORM

	If nKeyCode == 13
		
		cSeries = ""
		
		Sele TempgSer
		Go Top
		Scan	
			
			iF Not Empty(TempgSer.Serie)
			
				* Formamos la Cadena en pares
				cSeries = TempgSer.Serie  	+ Chr(13) +;
						  cSeries
			Endif
				
		Endscan
		
		Sele Temp
			Replace	Series	with  cSeries
		
		.Grid4.visible = .F.
		
		*Ir a la grid1
		.grid4.Setfocus()
		
	EndIf
	
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCE</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>grid</class>
		<classloc/>
		<baseclass>grid</baseclass>
		<objname>Grid3</objname>
		<parent>Formamsl1</parent>
		<properties>ColumnCount = 7
FontSize = 8
DeleteMark = .F.
GridLines = 2
Height = 198
Left = 10
Panel = 1
RecordMark = .F.
RowHeight = 17
ScrollBars = 2
TabIndex = 10
Top = 80
Width = 640
ZOrderSet = 45
Name = "Grid3"
Column1.FontSize = 8
Column1.Width = 56
Column1.ReadOnly = .T.
Column1.Visible = .T.
Column1.Name = "Column1"
Column2.FontSize = 8
Column2.Width = 67
Column2.ReadOnly = .T.
Column2.Visible = .T.
Column2.Name = "Column2"
Column3.FontSize = 8
Column3.ColumnOrder = 3
Column3.Width = 225
Column3.ReadOnly = .T.
Column3.Visible = .T.
Column3.Name = "Column3"
Column4.FontSize = 8
Column4.ColumnOrder = 5
Column4.Width = 83
Column4.ReadOnly = .T.
Column4.Visible = .T.
Column4.Format = "!kz"
Column4.InputMask = "9,999,999.99"
Column4.Name = "Column4"
Column5.FontSize = 8
Column5.ColumnOrder = 6
Column5.Width = 75
Column5.ReadOnly = .T.
Column5.Visible = .T.
Column5.Format = "!kz"
Column5.InputMask = "9,999,999.99"
Column5.Name = "Column5"
Column6.FontSize = 8
Column6.ColumnOrder = 4
Column6.Width = 19
Column6.ReadOnly = .T.
Column6.Visible = .T.
Column6.Name = "Column6"
Column7.FontSize = 8
Column7.ColumnOrder = 7
Column7.Width = 84
Column7.ReadOnly = .T.
Column7.Format = "!Kz"
Column7.InputMask = "9,999,999.99"
Column7.Name = "Column8"
</properties>
		<protected/>
		<methods>PROCEDURE AfterRowColChange
LPARAMETERS nColIndex

* Colorear renglón
if select('tempg')&gt;0
	Select Tempg
	ThisForm.ActiveRecno = Recno()
	this.Refresh()
	
endif

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCF</uniqueid>
		<timestamp>1181836728</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid3.Column1</parent>
		<properties>FontSize = 8
Caption = "Documento"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCG</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid3.Column1</parent>
		<properties>FontSize = 8
BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl


WITH THISFORM

	If nKeyCode == 13
		
		Sele TempgOrd
		 cNumOrd = TempgOrd.Numdoc
		
		 *Colocar el folio en su lugar
		.NumdocO.value  = Padl(Allt(cNumOrd),10)
		
		.Grid3.visible = .F.
		.grid3.refresh
		
		.NumdocO.Lostfocus()
		
	EndIf
	
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCH</uniqueid>
		<timestamp>1181836728</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid3.Column2</parent>
		<properties>FontSize = 8
Caption = "Fecha"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCI</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid3.Column2</parent>
		<properties>FontSize = 8
BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

WITH THISFORM

	If nKeyCode == 13
		
		Sele TempgOrd
		 cNumOrd = TempgOrd.Numdoc
		
		 *Colocar el folio en su lugar
		.NumdocO.value  = Padl(Allt(cNumOrd),10)
		
		.Grid3.visible = .F.
		.grid3.refresh
		
		.NumdocO.Lostfocus()
		
	EndIf
	
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCJ</uniqueid>
		<timestamp>1181836728</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid3.Column3</parent>
		<properties>FontSize = 8
Caption = "Proveedor"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCK</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid3.Column3</parent>
		<properties>FontSize = 8
BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

WITH THISFORM

	If nKeyCode == 13
		
		Sele TempgOrd
		 cNumOrd = TempgOrd.Numdoc
		
		 *Colocar el folio en su lugar
		.NumdocO.value  = Padl(Allt(cNumOrd),10)
		
		.Grid3.visible = .F.
		.grid3.refresh
		
		.NumdocO.Lostfocus()
		
	EndIf
	
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCL</uniqueid>
		<timestamp>1181836728</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid3.Column4</parent>
		<properties>FontSize = 8
Caption = "Importe"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCM</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid3.Column4</parent>
		<properties>FontSize = 8
BorderStyle = 0
Format = "!kz"
InputMask = "9,999,999.99"
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

WITH THISFORM

	If nKeyCode == 13
		
		Sele TempgOrd
		 cNumOrd = TempgOrd.Numdoc
		
		 *Colocar el folio en su lugar
		.NumdocO.value  = Padl(Allt(cNumOrd),10)
		
		.Grid3.visible = .F.
		.grid3.refresh
		
		.NumdocO.Lostfocus()
		
	EndIf
	
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCN</uniqueid>
		<timestamp>1181836728</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid3.Column5</parent>
		<properties>FontSize = 8
Caption = "Impuesto"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCO</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid3.Column5</parent>
		<properties>FontSize = 8
BorderStyle = 0
Format = "!kz"
InputMask = "9,999,999.99"
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

WITH THISFORM

	If nKeyCode == 13
		
		Sele TempgOrd
		 cNumOrd = TempgOrd.Numdoc
		
		 *Colocar el folio en su lugar
		.NumdocO.value  = Padl(Allt(cNumOrd),10)
		
		.Grid3.visible = .F.
		.grid3.refresh
		
		.NumdocO.Lostfocus()
		
	EndIf
	
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCP</uniqueid>
		<timestamp>1181836728</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid3.Column6</parent>
		<properties>FontSize = 8
Caption = "Divisa"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCQ</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid3.Column6</parent>
		<properties>FontSize = 8
BorderStyle = 0
Margin = 0
ReadOnly = .T.
Visible = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

WITH THISFORM

	If nKeyCode == 13
		
		Sele TempgOrd
		 cNumOrd = TempgOrd.Numdoc
		
		 *Colocar el folio en su lugar
		.NumdocO.value  = Padl(Allt(cNumOrd),10)
		
		.Grid3.visible = .F.
		.grid3.refresh
		
		.NumdocO.Lostfocus()
		
	EndIf
	
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCR</uniqueid>
		<timestamp>1181836728</timestamp>
		<class>header</class>
		<classloc/>
		<baseclass>header</baseclass>
		<objname>Header1</objname>
		<parent>Formamsl1.Grid3.Column8</parent>
		<properties>FontSize = 8
Caption = "Total"
Name = "Header1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_4B10QCQCS</uniqueid>
		<timestamp>1183476646</timestamp>
		<class>textbox</class>
		<classloc/>
		<baseclass>textbox</baseclass>
		<objname>Text1</objname>
		<parent>Formamsl1.Grid3.Column8</parent>
		<properties>BorderStyle = 0
Margin = 0
ReadOnly = .T.
ForeColor = 0,0,0
BackColor = 255,255,255
Name = "Text1"
</properties>
		<protected/>
		<methods>PROCEDURE KeyPress
LPARAMETERS nKeyCode, nShiftAltCtrl

WITH THISFORM

	If nKeyCode == 13
		
		Sele TempgOrd
		 cNumOrd = TempgOrd.Numdoc
		
		 *Colocar el folio en su lugar
		.NumdocO.value  = Padl(Allt(cNumOrd),10)
		
		.Grid3.visible = .F.
		.grid3.refresh
		
		.NumdocO.Lostfocus()
		
	EndIf
	
ENDWITH
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties>Arial, 0, 9, 5, 15, 12, 32, 3, 0
Arial, 0, 8, 5, 14, 11, 29, 3, 0
Arial, 1, 12, 8, 20, 15, 42, 4, 1
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
